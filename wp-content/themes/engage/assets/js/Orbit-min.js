class Orbit{constructor(){this.field=document.getElementById("orbit-field"),this.ballsEl=document.getElementById("orbit-balls"),this.gravitationalPull=80,this.gravityText=document.getElementById("orbit-current-gravity"),this.increasePullBtn=document.getElementById("orbit-increase-pull"),this.decreasePullBtn=document.getElementById("orbit-decrease-pull"),this.toggleAnimateBtn=document.getElementById("orbit-toggle-animate"),this.balls=null,this.animate=!0,this.ballSettings={num:80,minSize:4,maxSize:12},this.start=0,this.init(80)}init(t){this.balls=this.createBalls(t),window.requestAnimationFrame(this.step.bind(this)),this.setPullButtons(this.gravitationalPull),this.increasePullBtn.addEventListener("click",this.increaseGravitationalPull.bind(this)),this.decreasePullBtn.addEventListener("click",this.decreaseGravitationalPull.bind(this)),this.toggleAnimateBtn.addEventListener("click",this.toggleAnimate.bind(this))}createBalls(){let t;for(let i=0;i<this.ballSettings.num;i++)t=Math.ceil(this.ballSettings.minSize+Math.random()*(this.ballSettings.maxSize-this.ballSettings.minSize)),this.createBall(t);return document.querySelectorAll(".orbit-ball")}createBall(t){let i,e;i=document.createElement("div"),e=Math.round(1*Math.random())?"x":"y",i.classList.add("orbit-ball"),i.style.width=t+"px",i.style.height=t+"px",i.style.background=this.getRandomColor(),i.setAttribute("data-stretch-dir",e),i.setAttribute("data-stretch-val",1+5*Math.random()),i.setAttribute("data-grid",this.field.offsetWidth+Math.round(100*Math.random())),i.setAttribute("data-duration",3.5+Math.round(8*Math.random())),i.setAttribute("data-start",0),this.ballsEl.appendChild(i)}callStep(t){return this.step(t)}step(t){let i,e,l,a,s,n,h,r,d;for(let o=0;o<this.balls.length;o++)h=this.balls[o].getAttribute("data-start"),0==h&&(h=t,this.balls[o].setAttribute("data-start",h)),s=this.balls[o].getAttribute("data-grid"),n=this.balls[o].getAttribute("data-duration"),i=(t-h)/n/1e3,a=this.balls[o].getAttribute("data-stretch-val"),"x"===this.balls[o].getAttribute("data-stretch-dir")?(e=a*Math.sin(2*i*Math.PI)*(1.05-this.gravitationalPull/100),l=Math.cos(2*i*Math.PI)):(e=Math.sin(2*i*Math.PI),l=a*Math.cos(2*i*Math.PI)*(1.05-this.gravitationalPull/100)),r=this.field.clientWidth/2+s*e,d=this.field.clientHeight/2+s*l,this.balls[o].style.transform="translate3d("+r+"px, "+d+"px, 0)","x"===this.balls[o].getAttribute("data-stretch-dir")&&-1*(this.field.offsetWidth/2-this.balls[o].offsetWidth)<r&&r<this.field.offsetWidth/2+this.balls[o].offsetWidth||"y"===this.balls[o].getAttribute("data-stretch-dir")&&-1*(this.field.offsetWidth/2-this.balls[o].offsetWidth)<d&&d<this.field.offsetWidth/2+this.balls[o].offsetWidth?this.balls[o].style.zIndex="-1":this.balls[o].style.zIndex="9",i>=1&&this.balls[o].setAttribute("data-start",0);1==this.animate&&window.requestAnimationFrame(this.step.bind(this))}toggleAnimate(){this.animate=!this.animate,this.animate?(this.toggleAnimateBtn.innerHTML='<i class="fas fa-pause"></i>',window.requestAnimationFrame(this.step.bind(this))):this.toggleAnimateBtn.innerHTML='<i class="fas fa-play"></i>'}setGravitationalPull(t){let i,e,l,a;if(this.disablePullButtons(),!(t<0||100<t||t===this.gravitationalPull)){e=20,i=Math.abs(t-this.gravitationalPull)/20,a=t<this.gravitationalPull?"-":"+";for(let t=0;t<20;t++)l=t*(t/Math.PI),l<4&&(l=4),setTimeout(()=>{"-"===a?this.gravitationalPull-=i:this.gravitationalPull+=i},l),19===t&&setTimeout(()=>{this.gravitationalPull=Math.round(this.gravitationalPull),this.setPullButtons()},l+20)}}setPullButtons(){this.gravitationalPull<=0?(this.decreasePullBtn.disabled=!0,this.increasePullBtn.disabled=!1):100<=this.gravitationalPull?(this.decreasePullBtn.disabled=!1,this.increasePullBtn.disabled=!0):(this.decreasePullBtn.disabled=!1,this.increasePullBtn.disabled=!1),this.gravityText.innerHTML=this.gravitationalPull}disablePullButtons(){this.decreasePullBtn.disabled=!0,this.increasePullBtn.disabled=!0}increaseGravitationalPull(){this.setGravitationalPull(this.gravitationalPull+10)}decreaseGravitationalPull(){this.setGravitationalPull(this.gravitationalPull-10)}getCursorXY(t){let i=window.Event?t.pageX:event.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),e=window.Event?t.pageY:event.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);this.field.style.left=i-this.field.offsetWidth/2+"px",this.field.style.top=e-this.field.offsetHeight/2+"px"}getRandomColor(){let t=["#00a9b7","#005f86","#d6d2c4","#f8971f","#BF5700","#d9534f"];return t[Math.floor(Math.random()*t.length)]}}export default Orbit;